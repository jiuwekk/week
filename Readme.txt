
===================================================================================================
【更新时间】20210909
【版本编号】V1.05
【更新内容】
	1.适配阿尔特方面的协议
	2.重新整理故障等级
	3.应对客户的刹车策略,判定驾驶模式下的刹车请求,在刹车后让模式进入扭矩模式并0扭矩
	4.VCU发送紧急停车指令后进去ASC模式并不可恢复

===================================================================================================
【更新时间】20190624
【版本编号】V1.05
【更新内容】
	1.过压故障，禁止回馈，不限制驱动；欠压故障：禁止驱动，不限制回馈。
	2.电机标定低压平台：使用限制VS的形式
	3.ASC流程处理
	4.


===================================================================================================
【更新时间】20190622
【版本编号】V1.04
【更新内容】
	1.电机参数中增加UDMAX和UQMAX，在参数初始化时使用，电流环中断里不进行Id和Iq最大最小值赋值。
	2.电机温度和控制器温度都增加了滤波，滤波系数0.1，01M计算温度也改成了log的函数
	3.电机过温参数默认改成140，150，165摄氏度；逻辑电源故障增加计数处理
	4.增加最大输出扭矩限制，限制系数为PMSM.Var.TqMaxOutCutback
	5.增加主动放电功能：动作指令为6。上报故障有放电告警和放电超时，欠压3关管阈值设置成30V(放电设置成36V.)
	6.增加上电相线开路检测功能，
	7.AC过流2检测增加CurU,CurV,CurW作为判定过流的标准。
	8.CTRL_LV_MCU_101增加四代外壳控制器功能，宏定义#define USE_4C
	9.增加主控与发控协议的选择，再config.h文件中进行配置M_MOTRO_EN
	10.旋变零点-自转学习，增加初始零点判定过程，解决bug.



===================================================================================================
【更新时间】20190528
【版本编号】V1.03
【更新内容】
	1.参数配置增加184项SlopeIsMax驻坡输出最大扭矩（雷工给的是0.6）
	2.增加电机温度防突变处理。增加变量MotTemp1His和MotTemp2His.
	3.过压和欠压参数配置从系数改成标量值的形式，上位机参数配置表也变动。
	4.电机参数。h文件增加FW1_REF和FW2_REF,弱磁环使用。
	5.电机外特性IsMax增加0（超过标定转速100rpm就给零扭矩），(电机参数中修改)，避免高速低压问题。
	6.针对高出标定电压，增加限制，使用标定电压下IsMax，增加KCurrPIComp，IdWeak中起作用，解决高压下，扭矩给定后过流现象。
	7.匹配5合一低功率结温控制，注意电机零点3600,电机相序，不换相，发送控制器温度和电机温度。 ==》 发市场。


===================================================================================================
【更新时间】20190517
【版本编号】V1.02
【更新内容】
	1.MTPA循环测试功能，IsRef开始设定值来自，上位机给定。调试过程中角度最大和最小值根据角度进行变化。
	2.参数配置表中增加IsMaxRef用于电机标定IsMax标定中使用，上位机监控从F020更改成F060 对应版本05。16中文
	3.电机标定IfStudy中，步骤1中增加pi积分项和输出项清零执行语句。
	4.修改母线限流那块，全局有效Bug,（var.cutback）放到了Faults.c文件中比较去了。
	5.修复Ld计算错误，对于除法处理少加了括号,更新EV290电机参数（原来的是错误的Ld标定的），从ISR中计算放到了MainLoop==》ParmRefresh（）中。
	6.标定电机自旋零点学习中，锁定零点前增加电机转速判断（否则异常），不掉电可正常测试零点功能。
	7.增加NmFiltedVCU变量，对给整车发送的转速惊醒滤波，处理在Lpf_MainLoop函数中。
	8.IGBT温度处理部分，删除拟合处理数据，采用对数的形式，Bt基值不用随温度变化。
	9.整车控制中增加从驻坡模式切换到转矩模式后，增加降扭矩处理。
	10.历史故障只能记录4个字节（32位），修复后可记录64个。
	11。增加EE修改故障（关管），包括（参数版本，旋变零点，电流基准，转速基准，电机极对数，旋变极对数，旋变线数，旋变方向），注意：仅当上位机配置时，才执行。
	12.堵转时间配置成5s,堵转转速10rpm 主要避免驻坡是上报堵转故障。
	13.电流基准，电压基准，转速基准，Bemf,If参数配置最小值设置成1，防止做为除数异常。
	14.转速上电时刻修特别大的问题，在ISR中断上电时刻给QEP计数赋值时，同时给M1_QEP_HANDLE->QUTMR赋值（登峰）。（800，500，200转速下重启不报超速故障）。
	15.电机参数中限速PI参数宏定义ConfigParm.h中，扭矩环限速PI计算前需要对Ui行处理。
	16.Globals.h中配置参数定义增加索引号。PMSM.Var.变量名定义添加索引，增加CmdIsRefRamp斜坡处理后IsRef,参数配置表中CutBack滤波系数从10000改成2000。

===================================================================================================
【更新时间】20190430
【版本编号】V1.01
【更新内容】
	1.增加驻坡PI功能，PI参数需要调整
	2.修正速度模式控制函数中，切换Bug.
	3。增加控制模式的枚举类型定义，方便程序阅读
	4.母线电流限制，修改低速不限制Bug,并且将限制全局有效.
	5.电机参数配置表中，增加TABNREFCUR（特征电流标定时的最大电流），分别在Ld计算中，IsMaxCalc()中使用
	6.增加Ev290加长版电机参数，180电机参数（未详细标定）
	7.修复EVCBD_01M/02M/104M/107Z控制器参数中，MOTTEMPTYPE      1  （修正后）
	8.在中断函数中增加IsRef给定斜坡处理功能。
	9.标定-自转学零点，将开始锁定零点的变量ThetaU0Lock_His[0，1] = PMSM.Var.ThetaRawE & 0x0FFF  ==》ThetaU0Lock_His[0，1] = PMSM.Var.ThetaRT & 0x0FFF
	解决，旋变线反接自转学习零点失败问题。
	10.工程名以版本号命名MOTOR_CTRL_V101，版本号更新"MOTOR_CTRL_V101_20190430"

===================================================================================================
【更新时间】20190428
【版本编号】V1.00
【更新内容】
	1.标定中相序学习，零点学习，励磁电流学习，反电势学习，增加“深踩油门大于50%”
	2.更新EV290电机参数,未进行扭矩精度标定。
	3.电机堵转判定与故障处理
	4.IsMax标定过程中增加IdWeak Err数据。
	5.电池欠压故障，主控不给使能，禁止上报
	6.驱动限流和发电限流不受整车控制，驱动150A  发电50A.
	7.PWM变频 2HZ ==> 10Hz  PWM频率2k到5k(EV290电机).
	
===================================================================================================

