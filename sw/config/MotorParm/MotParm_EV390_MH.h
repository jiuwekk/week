// ================================================================================================
//! \file       MotParm_EV390_MH.h
//! \brief      明恒390电机
//! \author     XJH
//! \version    1.0.0
//! \date       2019.10.10
//! \copyright  SANTROLL.
// ================================================================================================

#ifndef _MOTPARM_EV390_MH_H_
#define _MOTPARM_EV390_MH_H_

//! @defgroup MOTPARM_EV390_MH
//! @{

#ifdef __cplusplus
extern "C" {
#endif
// ================================================================================================
// the includes

// ================================================================================================
// the defines

#define ELECZERO            1449       //!< 电机旋变零点，
#define CURBASE   (1800 * SQRT2)       //!< 电流基值(峰值)*0.1A
#define VOLTBASE            5400       //!< 电压基值*0.1V
#define SPEEDBASE           5000       //!< 转速基值
#define IF                  2252       //!< 等效励磁电流*0.1A
#define BEMF                1480       //!< 1000rpm反电势对应的电压 *0.1V
#define MOTPOLEPAIRS        8          //!< 电机极对数#
#define ENCODERPOLEPAIRS    4          //!< 旋变极对数#
#define SWAPENCODERDIR      0          //!< 旋变方向换向
#if EVCBD_ID == 0x05 || EVCBD_ID == 0x06
#define SWAPPHASE           1          //!< 电机相线换向
#else
#define SWAPPHASE           0          //!< 电机相线换向
#endif
// y = -0.016x3 - 0.2586x2 + 0.8038x + 0.006
#define MTPA_K3             -0.016     //!< MTPA拟合3次方系数#
#define MTPA_K2             (-0.2586)  //!< MTPA拟合2次方系数#
#define MTPA_K1             0.8038     //!< MTPA拟合1次方系数#
#define MTPA_K0             0.006      //!< MTPA拟合0次方系数#
#define PEAKPOWER           0          //!< 输出机械功率限制 ，0.1Kw,0=不限制
#define PEAKTORQUE          0          //!< 输出扭矩限制，  NM,0=不限制

#define PWM_LOW_FREQ        2000       //!< 低频，2K
#define PWM_HIGH_FREQ       5100       //!< 高频，5k 高低相等不变频
#define PWM_LOW_FREQ_HZ     2          //!< 低频，电机Hz
#define PWM_HIGH_FREQ_HZ    10         //!< 高频，电机Hz 高低相等不变频

#define KP_ID               1000       //!< D轴Kp参数*0.001
#define KI_ID               1000       //!< D轴Ki参数*0.0001
#define KP_IQ               1000       //!< Q轴Kp参数*0.001
#define KI_IQ               1000       //!< Q轴Ki参数*0.0001
#define KP_FW1              250        //!< IdWeak_Kp参数*0.001
#define KI_FW1              58         //!< IdWeak_Ki参数*0.0001
#define KP_FW2              62         //!< AngleWeak_Kp参数*0.001
#define KI_FW2              15         //!< AngleWeak_Ki参数*0.0001
#define FW1_REF             1.05       //!< IdWeak参考
#define FW2_REF             1.05       //!< AngleWeak参考
#define UDMAX               1.4        //!< D轴电压最大值
#define UQMAX               1.4        //!< Q轴电压最大值

#define DCOVERCUR           5000       //!< 母线过流       0.1A
#define ACOVERCUR1          5000       //!< 相线过流1 0.1A(峰值)
#define ACOVERCUR2          5500       //!< 相线过流2 0.1A(峰值)
#define DCOVERVOLT3         7800       //!< 电压过压3 0.1V
#define DCOVERVOLT2         7500       //!< 电压过压2 0.1V
#define DCOVERVOLT1         7200       //!< 电压过压1 0.1V
#define DCUNDERVOLT1        3000       //!< 电压欠压1 0.1V
#define DCUNDERVOLT2        2000       //!< 电压欠压2 0.1V
#define DCUNDERVOLT3         300       //!< 电压欠压3 0.1V

#define OVERSPD1            3500       //!< 超速1转速
#define OVERSPD2            4000       //!< 超速2转速
#define KP_SPDLIMIT         4000       //!< 限速Kp参数*0.001
#define KI_SPDLIMIT         200        //!< 限速Ki参数*0.0001

#define DIRVECURLIMIT       5000       //!< 驱动母线电流限制*0.1A
#define BRAKECURLIMIT       5000       //!< 制动母线电流限制*0.1A
#define KP_IDCLIMIT         500        //!< 母线限流Kp参数*0.001
#define KI_IDCLIMIT         100        //!< 母线限流Ki参数*0.0001


#define KP_SPDM0            8000       //!< 速度模式0Kp参数*0.001
#define KI_SPDM0            200        //!< 速度模式0Ki参数*0.0001
#define KP_SPDM1            1000       //!< 速度模式1Kp参数*0.001
#define KI_SPDM1            100        //!< 速度模式1Ki参数*0.0001
#define KP_SPDM2            1000       //!< 速度模式2Kp参数*0.001
#define KI_SPDM2            100        //!< 速度模式2Ki参数*0.0001

#define PT100_1             1          //!< PT100_1 0==>没有
#define PT100_2             1          //!< PT100_2 0==>没有

#define TABNSTART           1000       //!< 电机特性表中转速起始值rpm
#define TABNEND             3500       //!< 电机特性表中转速最高值rpm
#define TABNNUM             26         //!< 电机特性表中转速点数
#define TABNREFU            2500       //!< 测定特性表时的电压0.1V
#define TABNREFCUR     (1800 * SQRT2)  //!< 测点特性表时的电流0.1A
#define TABYNUM             11         //!< 特性表二维表列数


#define TM_TAB {385,367,345,324,305,287,269,255,240,230,\
        219,208,198,190,182,174,167,160,154,148,\
        143,138,133,128,124,120,}

// 2019.05.17 修改真正的Ld后标定出,再经过扭矩后标定
#define ISM_TAB {\
        1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,0.9705,0.9309,0.8850,0.8589,\
        0.8298,0.7993,0.7622,0.7373,0.7170,0.6902,0.6733,0.6560,0.6362,0.6250,\
        0.6104,0.5942,0.5801,0.5688,0.5540,0.5452,}

#define TLIN_TAB  {\
        0.0000,0.1230,0.2367,0.3427,0.4435,0.5381,0.6293,0.7195,0.8112,0.9010,1.0000,\
        0.0000,0.1203,0.2297,0.3318,0.4263,0.5155,0.6028,0.6881,0.7771,0.8827,1.0000,\
        0.0000,0.1136,0.2171,0.3145,0.4049,0.4890,0.5714,0.6643,0.7647,0.8750,1.0000,\
        0.0000,0.1075,0.2078,0.2978,0.3832,0.4650,0.5526,0.6510,0.7573,0.8700,1.0000,\
        0.0000,0.1013,0.1963,0.2811,0.3621,0.4500,0.5436,0.6407,0.7471,0.8624,1.0000,\
        0.0000,0.0953,0.1850,0.2661,0.3497,0.4400,0.5353,0.6341,0.7415,0.8609,1.0000,\
        0.0000,0.0950,0.1764,0.2588,0.3496,0.4464,0.5414,0.6392,0.7450,0.8609,1.0000,\
        0.0000,0.0900,0.1747,0.2629,0.3548,0.4464,0.5392,0.6392,0.7461,0.8610,1.0000,\
        0.0000,0.0857,0.1667,0.2500,0.3370,0.4292,0.5292,0.6304,0.7364,0.8556,1.0000,\
        0.0000,0.0877,0.1632,0.2422,0.3277,0.4167,0.5122,0.6124,0.7220,0.8424,1.0000,\
        0.0000,0.0868,0.1613,0.2374,0.3192,0.4065,0.5009,0.5952,0.7089,0.8353,1.0000,\
        0.0000,0.0862,0.1580,0.2312,0.3117,0.3979,0.4918,0.5900,0.6979,0.8307,1.0000,\
        0.0000,0.0817,0.1543,0.2262,0.3018,0.3909,0.4800,0.5800,0.6929,0.8200,1.0000,\
        0.0000,0.0813,0.1514,0.2212,0.2992,0.3841,0.4724,0.5717,0.6850,0.8118,1.0000,\
        0.0000,0.0783,0.1481,0.2167,0.2917,0.3762,0.4650,0.5647,0.6750,0.8091,1.0000,\
        0.0000,0.0748,0.1422,0.2070,0.2817,0.3684,0.4589,0.5553,0.6640,0.8073,1.0000,\
        0.0000,0.0726,0.1385,0.2005,0.2764,0.3575,0.4456,0.5431,0.6543,0.7858,1.0000,\
        0.0000,0.0727,0.1385,0.2000,0.2696,0.3474,0.4353,0.5333,0.6429,0.7800,1.0000,\
        0.0000,0.0700,0.1352,0.1968,0.2695,0.3474,0.4318,0.5271,0.6433,0.7782,1.0000,\
        0.0000,0.0705,0.1344,0.1936,0.2629,0.3389,0.4238,0.5186,0.6262,0.7650,1.0000,\
        0.0000,0.0686,0.1325,0.1925,0.2600,0.3353,0.4213,0.5138,0.6267,0.7700,1.0000,\
        0.0000,0.0652,0.1267,0.1837,0.2516,0.3265,0.4080,0.4993,0.6055,0.7412,1.0000,\
        0.0000,0.0633,0.1233,0.1787,0.2432,0.3156,0.3987,0.4873,0.5950,0.7243,1.0000,\
        0.0000,0.0645,0.1242,0.1779,0.2422,0.3156,0.3962,0.4820,0.5850,0.7300,1.0000,\
        0.0000,0.0620,0.1209,0.1748,0.2367,0.3067,0.3893,0.4771,0.5767,0.7100,1.0000,\
        0.0000,0.0637,0.1226,0.1752,0.2356,0.3033,0.3840,0.4746,0.5800,0.7271,1.0000}
// ================================================================================================
// the typedefs


// ================================================================================================
// the globals


// ================================================================================================
// the function prototypes




// ================================================================================================
#ifdef __cplusplus
}
#endif // extern "C"

//! @} // end of MOTPARM_EV390_MH

#endif // end of _MOTPARM_EV390_MH_H_
