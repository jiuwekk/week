// ================================================================================================
//! \file       MotParm_EV290_169_X.h
//! \brief      290斜级电机
//! \author     XJH
//! \version    1.0.0
//! \date       2019.07.01
//! \copyright  SANTROLL.
// ================================================================================================

#ifndef _MOTPARM_EV290_169_X_H_
#define _MOTPARM_EV290_169_X_H_

//! @defgroup MOTPARM_EV290_169_X
//! @{

#ifdef __cplusplus
extern "C" {
#endif
// ================================================================================================
// the includes

// ================================================================================================
// the defines

#define ELECZERO            989        //!< 电机旋变零点，0701日，改完斜级，截距后。两段斜级整距
#define CURBASE   (3700 * SQRT2)       //!< 电流基值(峰值)*0.1A
#define VOLTBASE            5400       //!< 电压基值*0.1V
#define SPEEDBASE           5000       //!< 转速基值
#define IF                  2518       //!< 等效励磁电流*0.1A
#define BEMF                1886       //!< 1000rpm反电势对应的电压 *0.1V
#define MOTPOLEPAIRS        5          //!< 电机极对数#
#define ENCODERPOLEPAIRS    5          //!< 旋变极对数#
#define SWAPENCODERDIR      0          //!< 旋变方向换向
#if EVCBD_ID == 0x05 || EVCBD_ID == 0x06
#define SWAPPHASE           0          //!< 电机相线换向
#else
#define SWAPPHASE           1          //!< 电机相线换向
#endif
// y = 1.8084x3 - 3.9676x2 + 2.9877x + 0.0196
#define MTPA_K3             1.8084     //!< MTPA拟合3次方系数#
#define MTPA_K2             (-3.9676)  //!< MTPA拟合2次方系数#
#define MTPA_K1             2.9877     //!< MTPA拟合1次方系数#
#define MTPA_K0             0.0196     //!< MTPA拟合0次方系数#
#define PEAKPOWER           0          //!< 输出机械功率限制 ，0.1Kw,0=不限制
#define PEAKTORQUE          0          //!< 输出扭矩限制，  NM,0=不限制

#define PWM_LOW_FREQ        2000       //!< 低频，2K
#define PWM_HIGH_FREQ       4800       //!< 高频，5k 高低相等不变频
#define PWM_LOW_FREQ_HZ     2          //!< 低频，电机Hz
#define PWM_HIGH_FREQ_HZ    10         //!< 高频，电机Hz 高低相等不变频

#define KP_ID               2500       //!< D轴Kp参数*0.001
#define KI_ID               1800        //!< D轴Ki参数*0.0001
#define KP_IQ               2500       //!< Q轴Kp参数*0.001
#define KI_IQ               1800        //!< Q轴Ki参数*0.0001
#define KP_FW1              250        //!< IdWeak_Kp参数*0.001
#define KI_FW1              58         //!< IdWeak_Ki参数*0.0001
#define KP_FW2              62         //!< AngleWeak_Kp参数*0.001
#define KI_FW2              15         //!< AngleWeak_Ki参数*0.0001
#define FW1_REF             1.05       //!< IdWeak参考
#define FW2_REF             1.05       //!< AngleWeak参考
#define UDMAX               1.4        //!< D轴电压最大值
#define UQMAX               1.4        //!< Q轴电压最大值

#define DCOVERCUR           5000       //!< 母线过流       0.1A
#define ACOVERCUR1          4000       //!< 相线过流1 0.1A(峰值)
#define ACOVERCUR2          4500       //!< 相线过流2 0.1A(峰值)
#define DCOVERVOLT3         7800       //!< 电压过压3 0.1V
#define DCOVERVOLT2         7500       //!< 电压过压2 0.1V
#define DCOVERVOLT1         7200       //!< 电压过压1 0.1V
#define DCUNDERVOLT1        4000       //!< 电压欠压1 0.1V
#define DCUNDERVOLT2        3000       //!< 电压欠压2 0.1V
#define DCUNDERVOLT3         300       //!< 电压欠压3 0.1V

#define OVERSPD1            3500       //!< 超速1转速
#define OVERSPD2            8000       //!< 超速2转速
#define KP_SPDLIMIT         4000       //!< 限速Kp参数*0.001
#define KI_SPDLIMIT         200        //!< 限速Ki参数*0.0001

#define DIRVECURLIMIT       5000       //!< 驱动母线电流限制*0.1A
#define BRAKECURLIMIT       5000       //!< 制动母线电流限制*0.1A
#define KP_IDCLIMIT         500        //!< 母线限流Kp参数*0.001
#define KI_IDCLIMIT         100        //!< 母线限流Ki参数*0.0001


#define KP_SPDM0            8000       //!< 速度模式0Kp参数*0.001
#define KI_SPDM0            200        //!< 速度模式0Ki参数*0.0001
#define KP_SPDM1            1000       //!< 速度模式1Kp参数*0.001
#define KI_SPDM1            100        //!< 速度模式1Ki参数*0.0001
#define KP_SPDM2            1000       //!< 速度模式2Kp参数*0.001
#define KI_SPDM2            100        //!< 速度模式2Ki参数*0.0001

#define PT100_1             0          //!< PT100_1 0==>没有
#define PT100_2             1          //!< PT100_2 0==>没有

#define TABNSTART           800        //!< 电机特性表中转速起始值rpm
#define TABNEND             3600       //!< 电机特性表中转速最高值rpm
#define TABNNUM             29         //!< 电机特性表中转速点数
#define TABNREFU            4000       //!< 测定特性表时的电压0.1V
#define TABNREFCUR     (3700 * SQRT2)  //!< 测点特性表时的电流0.1A
#define TABYNUM             11         //!< 特性表二维表列数


#define TM_TAB {1025,1017,1015,1002,937,863,788,717,655,602,\
        556,515,482,453,425,401,379,359,341,326,\
        310,296,283,271,260,252,242,233,220}

// 2019.05.17 修改真正的Ld后标定出,再经过扭矩后标定
#define ISM_TAB {\
        1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,1.0000,0.9800,0.9310,\
        0.8711,0.8303,0.7770,0.7317,0.6968,0.6588,0.6260,0.6012,0.5740,0.5450,\
        0.5214,0.5026,0.4847,0.4521,0.4498,0.4308,0.4191,0.4023,0.3850}

#define TLIN_TAB  {\
0.0000,0.1115,0.2051,0.2919,0.3809,0.4700,0.5630,0.6607,0.7653,0.8781,1.0000,\
0.0000,0.1108,0.2047,0.2923,0.3800,0.4689,0.5619,0.6603,0.7642,0.8765,1.0000,\
0.0000,0.1106,0.2043,0.2918,0.3800,0.4689,0.5611,0.6589,0.7645,0.8770,1.0000,\
0.0000,0.1094,0.2021,0.2884,0.3761,0.4640,0.5564,0.6533,0.7560,0.8668,1.0000,\
0.0000,0.1043,0.1903,0.2716,0.3538,0.4367,0.5206,0.6083,0.7085,0.8338,1.0000,\
0.0000,0.0970,0.1774,0.2538,0.3286,0.4033,0.4847,0.5754,0.6793,0.8052,1.0000,\
0.0000,0.0885,0.1647,0.2354,0.3030,0.3781,0.4587,0.5471,0.6485,0.7740,1.0000,\
0.0000,0.0815,0.1518,0.2184,0.2842,0.3568,0.4351,0.5204,0.6152,0.7381,1.0000,\
0.0000,0.0762,0.1433,0.2068,0.2750,0.3472,0.4235,0.5049,0.5972,0.7155,1.0000,\
0.0000,0.0734,0.1409,0.2054,0.2762,0.3494,0.4263,0.5100,0.6048,0.7220,1.0000,\
0.0000,0.0732,0.1429,0.2116,0.2847,0.3611,0.4418,0.5287,0.6256,0.7449,1.0000,\
0.0000,0.0715,0.1425,0.2140,0.2897,0.3685,0.4500,0.5366,0.6333,0.7500,1.0000,\
0.0000,0.0730,0.1483,0.2256,0.3047,0.3864,0.4693,0.5596,0.6587,0.7686,1.0000,\
0.0000,0.0768,0.1564,0.2380,0.3207,0.4047,0.4902,0.5786,0.6688,0.7762,1.0000,\
0.0000,0.0773,0.1600,0.2441,0.3264,0.4067,0.4885,0.5716,0.6609,0.7681,1.0000,\
0.0000,0.0743,0.1524,0.2347,0.3188,0.3990,0.4825,0.5689,0.6614,0.7703,1.0000,\
0.0000,0.0702,0.1454,0.2260,0.3102,0.3944,0.4787,0.5643,0.6569,0.7681,1.0000,\
0.0000,0.0665,0.1396,0.2198,0.3014,0.3830,0.4676,0.5558,0.6506,0.7624,1.0000,\
0.0000,0.0631,0.1338,0.2147,0.2940,0.3768,0.4615,0.5505,0.6479,0.7626,1.0000,\
0.0000,0.0627,0.1314,0.2093,0.2888,0.3737,0.4595,0.5506,0.6510,0.7725,1.0000,\
0.0000,0.0620,0.1293,0.2050,0.2825,0.3667,0.4543,0.5469,0.6483,0.7696,1.0000,\
0.0000,0.0592,0.1230,0.1970,0.2747,0.3571,0.4442,0.5361,0.6363,0.7590,1.0000,\
0.0000,0.0590,0.1215,0.1923,0.2700,0.3515,0.4381,0.5314,0.6336,0.7557,1.0000,\
0.0000,0.0565,0.1172,0.1925,0.2697,0.3532,0.4434,0.5396,0.6432,0.7679,1.0000,\
0.0000,0.0553,0.1135,0.1838,0.2588,0.3400,0.4276,0.5192,0.6227,0.7500,1.0000,\
0.0000,0.0548,0.1116,0.1779,0.2542,0.3367,0.4230,0.5176,0.6219,0.7518,1.0000,\
0.0000,0.0550,0.1119,0.1773,0.2510,0.3310,0.4162,0.5104,0.6180,0.7488,1.0000,\
0.0000,0.0542,0.1103,0.1769,0.2490,0.3278,0.4152,0.5095,0.6179,0.7513,1.0000,\
0.0000,0.0542,0.1103,0.1769,0.2490,0.3278,0.4152,0.5095,0.6179,0.7513,1.0000}
// ================================================================================================
// the typedefs


// ================================================================================================
// the globals


// ================================================================================================
// the function prototypes




// ================================================================================================
#ifdef __cplusplus
}
#endif // extern "C"

//! @} // end of MOTPARM_EV290_169_X

#endif // end of _MOTPARM_EV290_169_X_H_
